<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û - ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏™‡∏á‡∏Ç‡∏•‡∏≤</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    * {
            font-family: 'Sarabun', sans-serif;
        }
        .form-card {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }
        .input-field {
            transition: all 0.2s ease;
        }
        .input-field:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            transition: all 0.2s ease;
        }
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        .btn-secondary {
            transition: all 0.2s ease;
        }
        .btn-secondary:hover {
            background-color: #e5e7eb;
        }
        .error-text {
            color: #dc2626;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        .radio-custom:checked + label {
            background-color: #eff6ff;
            border-color: #3b82f6;
        }
        .checkbox-custom:checked + label {
            background-color: #eff6ff;
            border-color: #3b82f6;
        }
        .table-container {
            overflow-x: auto;
        }
        .admin-table th {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
        }
        .fade-in {
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loading-spinner {
            border: 3px solid #e5e7eb;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
  <style>body { box-sizing: border-box; }</style>
 </head>
 <body class="h-full bg-gradient-to-br from-blue-50 via-white to-gray-100">
  <div id="app" class="h-full overflow-auto"><!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° -->
   <div id="formPage" class="min-h-full py-8 px-4">
    <div class="max-w-3xl mx-auto"><!-- Header -->
     <header class="text-center mb-8">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-blue-600 rounded-full mb-4">
       <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
       </svg>
      </div>
      <h1 id="formTitle" class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</h1>
      <p class="text-lg text-blue-600 font-medium">‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡πá‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏¢‡∏≤‡∏ß‡∏ä‡∏ô ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏∏‡∏î‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
      <p id="orgName" class="text-gray-600 mt-1">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏™‡∏á‡∏Ç‡∏•‡∏≤</p>
     </header><!-- ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ -->
      <div class="bg-blue-50 border-l-4 border-blue-500 p-5 rounded-r-lg mb-8 form-card">
      <p class="text-gray-700 leading-relaxed">‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô <strong class="text-blue-700">"‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏∏‡∏Ç"</strong> ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 30 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ ‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ô‡∏≥‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏õ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏ú‡∏ô‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>
      </div><!-- Form Card -->
     <form id="surveyForm" class="bg-white rounded-2xl form-card p-6 md:p-8"><!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 -->
      <section class="mb-8">
       <h2 class="text-xl font-bold text-blue-700 mb-6 pb-3 border-b-2 border-blue-200 flex items-center"><span class="inline-flex items-center justify-center w-8 h-8 bg-blue-600 text-white rounded-full text-sm font-bold mr-3">1</span> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h2><!-- ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏∏‡∏• -->
       <div class="mb-6"><label for="fullname" class="block text-gray-700 font-medium mb-2"> ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• <span class="text-red-500">*</span> </label> <input type="text" id="fullname" name="fullname" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•">
        <p id="fullnameError" class="error-text hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</p>
       </div><!-- ‡πÄ‡∏û‡∏® -->
       <div class="mb-6"><label class="block text-gray-700 font-medium mb-3"> ‡πÄ‡∏û‡∏® <span class="text-red-500">*</span> </label>
        <div class="flex flex-wrap gap-4">
         <div class="flex items-center"><input type="radio" id="male" name="gender" value="‡∏ä‡∏≤‡∏¢" class="radio-custom hidden"> <label for="male" class="flex items-center px-5 py-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all"> <span class="w-5 h-5 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center"> <span class="w-3 h-3 bg-blue-600 rounded-full hidden"></span> </span> ‡∏ä‡∏≤‡∏¢ </label>
         </div>
         <div class="flex items-center"><input type="radio" id="female" name="gender" value="‡∏´‡∏ç‡∏¥‡∏á" class="radio-custom hidden"> <label for="female" class="flex items-center px-5 py-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all"> <span class="w-5 h-5 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center"> <span class="w-3 h-3 bg-blue-600 rounded-full hidden"></span> </span> ‡∏´‡∏ç‡∏¥‡∏á </label>
         </div>
        </div>
        <p id="genderError" class="error-text hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®</p>
       </div><!-- ‡∏≠‡∏≤‡∏¢‡∏∏ -->
       <div class="mb-6"><label class="block text-gray-700 font-medium mb-3"> ‡∏≠‡∏≤‡∏¢‡∏∏ <span class="text-red-500">*</span> </label>
        <div class="flex flex-wrap gap-3">
         <div class="flex items-center"><input type="radio" id="age1" name="age" value="13 ‚Äì 15 ‡∏õ‡∏µ" class="radio-custom hidden"> <label for="age1" class="flex items-center px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> 13 ‚Äì 15 ‡∏õ‡∏µ </label>
         </div>
         <div class="flex items-center"><input type="radio" id="age2" name="age" value="16 ‚Äì 25 ‡∏õ‡∏µ" class="radio-custom hidden"> <label for="age2" class="flex items-center px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> 16 ‚Äì 25 ‡∏õ‡∏µ </label>
         </div>
         <div class="flex items-center"><input type="radio" id="age3" name="age" value="25 ‡∏õ‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ" class="radio-custom hidden"> <label for="age3" class="flex items-center px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> 25 ‡∏õ‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ </label>
         </div>
        </div>
        <p id="ageError" class="error-text hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏</p>
       </div><!-- ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
       <div class="mb-6"><label class="block text-gray-700 font-medium mb-3"> ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="text-red-500">*</span> </label>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
         <div class="flex items-center"><input type="radio" id="edu1" name="education" value="‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤" class="radio-custom hidden"> <label for="edu1" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤ </label>
         </div>
         <div class="flex items-center"><input type="radio" id="edu2" name="education" value="‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏ï‡πâ‡∏ô" class="radio-custom hidden"> <label for="edu2" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏ï‡πâ‡∏ô </label>
         </div>
         <div class="flex items-center"><input type="radio" id="edu3" name="education" value="‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢" class="radio-custom hidden"> <label for="edu3" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢ </label>
         </div>
         <div class="flex items-center"><input type="radio" id="edu4" name="education" value="‡∏õ‡∏ß‡∏ä." class="radio-custom hidden"> <label for="edu4" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏õ‡∏ß‡∏ä. </label>
         </div>
         <div class="flex items-center"><input type="radio" id="edu5" name="education" value="‡∏õ‡∏ß‡∏™." class="radio-custom hidden"> <label for="edu5" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏õ‡∏ß‡∏™. </label>
         </div>
         <div class="flex items-center"><input type="radio" id="edu6" name="education" value="‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÉ‡∏î" class="radio-custom hidden"> <label for="edu6" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span>‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ </label>
              </div>
        </div>
        <div class="mt-3">
         <div class="flex items-center"><input type="radio" id="edu7" name="education" value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" class="radio-custom hidden" onchange="toggleEducationOther()"> <label for="edu7" class="flex items-center px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ </label>
         </div>
         <div id="educationOtherContainer" class="hidden mt-2 ml-6"><input type="text" id="educationOther" name="educationOther" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤">
         </div>
        </div>
        <p id="educationError" class="error-text hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
       </div><!-- ‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤ -->
       <div class="mb-6"><label class="block text-gray-700 font-medium mb-3"> ‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤ <span class="text-red-500">*</span> </label>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
         <div>
          <div class="flex items-center"><input type="radio" id="prov1" name="province" value="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏á‡∏Ç‡∏•‡∏≤" class="radio-custom hidden" onchange="toggleProvinceFields()"> <label for="prov1" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏á‡∏Ç‡∏•‡∏≤ </label>
            </div>
          <div id="songkhlaDistrictContainer" class="hidden mt-2 ml-6"><input type="text" id="songkhlaDistrict" name="songkhlaDistrict" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
          </div>
         </div>
         <div class="flex items-center"><input type="radio" id="prov2" name="province" value="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏¢‡∏∞‡∏•‡∏≤" class="radio-custom hidden" onchange="toggleProvinceFields()"> <label for="prov2" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏¢‡∏∞‡∏•‡∏≤ </label>
         </div>
         <div class="flex items-center"><input type="radio" id="prov3" name="province" value="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ" class="radio-custom hidden" onchange="toggleProvinceFields()"> <label for="prov3" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ </label>
         </div>
         <div class="flex items-center"><input type="radio" id="prov4" name="province" value="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™" class="radio-custom hidden" onchange="toggleProvinceFields()"> <label for="prov4" class="flex items-center w-full px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex-shrink-0 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™ </label>
         </div>
        </div>
        <div class="mt-3">
         <div class="flex items-center"><input type="radio" id="prov5" name="province" value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" class="radio-custom hidden" onchange="toggleProvinceFields()"> <label for="prov5" class="flex items-center px-4 py-2 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-all text-sm"> <span class="w-4 h-4 border-2 border-gray-300 rounded-full mr-2 flex items-center justify-center"> <span class="w-2 h-2 bg-blue-600 rounded-full hidden"></span> </span> ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ </label>
         </div>
         <div id="provinceOtherContainer" class="hidden mt-2 ml-6"><input type="text" id="provinceOther" name="provinceOther" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
         </div>
        </div>
        <p id="provinceError" class="error-text hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤</p>
       </div>
      </section><!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 -->
      <section class="mb-8">
       <h2 class="text-xl font-bold text-blue-700 mb-6 pb-3 border-b-2 border-blue-200 flex items-center"><span class="inline-flex items-center justify-center w-8 h-8 bg-blue-600 text-white rounded-full text-sm font-bold mr-3">2</span> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</h2><!-- ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ -->
       <div class="mb-6"><label class="block text-gray-700 font-medium mb-3"> ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏° <span class="text-gray-500 text-sm">(‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏Ç‡πâ‡∏≠)</span> </label>
        <div class="space-y-4"><!-- ‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• -->
         <div class="border-2 border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-all">
          <div class="flex items-start"><input type="checkbox" id="course1" name="courses" value="‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•" class="checkbox-custom hidden" onchange="toggleCourseDetail('digital')"> <label for="course1" class="flex items-center cursor-pointer"> <span class="w-5 h-5 border-2 border-gray-300 rounded mr-3 flex items-center justify-center flex-shrink-0">
             <svg class="w-3 h-3 text-blue-600 hidden" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
             </svg></span> <span class="font-medium text-gray-700">‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</span> </label>
          </div>
          <div id="courseDigitalDetail" class="hidden mt-3 ml-8"><input type="text" id="courseDigitalText" name="courseDigitalText" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå, ‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢">
          </div>
         </div><!-- ‡∏î‡πâ‡∏≤‡∏ô‡∏®‡∏¥‡∏•‡∏õ‡∏´‡∏±‡∏ï‡∏ñ‡∏Å‡∏£‡∏£‡∏° -->
         <div class="border-2 border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-all">
          <div class="flex items-start"><input type="checkbox" id="course2" name="courses" value="‡∏î‡πâ‡∏≤‡∏ô‡∏®‡∏¥‡∏•‡∏õ‡∏´‡∏±‡∏ï‡∏ñ‡∏Å‡∏£‡∏£‡∏°/‡∏á‡∏≤‡∏ô‡∏ù‡∏µ‡∏°‡∏∑‡∏≠" class="checkbox-custom hidden" onchange="toggleCourseDetail('craft')"> <label for="course2" class="flex items-center cursor-pointer"> <span class="w-5 h-5 border-2 border-gray-300 rounded mr-3 flex items-center justify-center flex-shrink-0">
             <svg class="w-3 h-3 text-blue-600 hidden" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
             </svg></span> <span class="font-medium text-gray-700">‡∏î‡πâ‡∏≤‡∏ô‡∏®‡∏¥‡∏•‡∏õ‡∏´‡∏±‡∏ï‡∏ñ‡∏Å‡∏£‡∏£‡∏°/‡∏á‡∏≤‡∏ô‡∏ù‡∏µ‡∏°‡∏∑‡∏≠</span> </label>
          </div>
          <div id="courseCraftDetail" class="hidden mt-3 ml-8"><input type="text" id="courseCraftText" name="courseCraftText" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏±‡∏î‡πÄ‡∏¢‡πá‡∏ö‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤, ‡∏á‡∏≤‡∏ô‡∏ú‡πâ‡∏≤‡∏ö‡∏≤‡∏ï‡∏¥‡∏Å">
          </div>
         </div><!-- ‡∏î‡πâ‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏° -->
         <div class="border-2 border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-all">
          <div class="flex items-start"><input type="checkbox" id="course3" name="courses" value="‡∏î‡πâ‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô" class="checkbox-custom hidden" onchange="toggleCourseDetail('mechanic')"> <label for="course3" class="flex items-center cursor-pointer"> <span class="w-5 h-5 border-2 border-gray-300 rounded mr-3 flex items-center justify-center flex-shrink-0">
             <svg class="w-3 h-3 text-blue-600 hidden" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
             </svg></span> <span class="font-medium text-gray-700">‡∏î‡πâ‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</span> </label>
          </div>
          <div id="courseMechanicDetail" class="hidden mt-3 ml-8"><input type="text" id="courseMechanicText" name="courseMechanicText" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤, ‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏ô‡∏ï‡πå">
          </div>
         </div><!-- ‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏° -->
         <div class="border-2 border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-all">
          <div class="flex items-start"><input type="checkbox" id="course4" name="courses" value="‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°" class="checkbox-custom hidden" onchange="toggleCourseDetail('agriculture')"> <label for="course4" class="flex items-center cursor-pointer"> <span class="w-5 h-5 border-2 border-gray-300 rounded mr-3 flex items-center justify-center flex-shrink-0">
             <svg class="w-3 h-3 text-blue-600 hidden" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
             </svg></span> <span class="font-medium text-gray-700">‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏´‡∏Å‡∏£‡∏£‡∏°</span> </label>
          </div>
          <div id="courseAgricultureDetail" class="hidden mt-3 ml-8"><input type="text" id="courseAgricultureText" name="courseAgricultureText" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ä‡∏ü‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô,‡∏ö‡∏≤‡∏£‡∏¥‡∏™‡∏ï‡πâ‡∏≤ ">
          </div>
         </div><!-- ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ -->
         <div class="border-2 border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-all">
          <div class="flex items-start"><input type="checkbox" id="course5" name="courses" value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" class="checkbox-custom hidden" onchange="toggleCourseDetail('other')"> <label for="course5" class="flex items-center cursor-pointer"> <span class="w-5 h-5 border-2 border-gray-300 rounded mr-3 flex items-center justify-center flex-shrink-0">
             <svg class="w-3 h-3 text-blue-600 hidden" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
             </svg></span> <span class="font-medium text-gray-700">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</span> </label>
          </div>
          <div id="courseOtherDetail" class="hidden mt-3 ml-8"><input type="text" id="courseOtherText" name="courseOtherText" class="input-field w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£">
          </div>
         </div>
        </div>
       </div><!-- ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏° -->
       <div class="mb-6"><label for="trainingTime" class="block text-gray-700 font-medium mb-2"> ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏° <span class="text-red-500">*</span> </label> <input type="text" id="trainingTime" name="trainingTime" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå, ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏¢‡πá‡∏ô 17.00-20.00 ‡∏ô.">
        <p id="trainingTimeError" class="error-text hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</p>
       </div><!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏° -->
       <div class="mb-6"><label for="trainingLocation" class="block text-gray-700 font-medium mb-2"> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏° <span class="text-red-500">*</span> </label> <input type="text" id="trainingLocation" name="trainingLocation" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏™‡∏á‡∏Ç‡∏•‡∏≤, ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏ö‡πâ‡∏≤‡∏ô">
        <p id="trainingLocationError" class="error-text hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</p>
       </div><!-- ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ -->
       <div class="mb-6"><label for="suggestions" class="block text-gray-700 font-medium mb-2"> ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ </label> <textarea id="suggestions" name="suggestions" rows="4" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none resize-none" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"></textarea>
       </div>
      </section><!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô -->
      <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200"><button type="submit" id="submitBtn" class="btn-primary flex-1 px-6 py-4 text-white font-semibold rounded-xl flex items-center justify-center">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg><span id="submitBtnText">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
        <div id="submitSpinner" class="loading-spinner ml-2 hidden"></div></button> <button type="button" onclick="clearForm()" class="btn-secondary flex-1 px-6 py-4 bg-gray-100 text-gray-700 font-semibold rounded-xl flex items-center justify-center">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
        </svg> ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• </button>
      </div>
     </form><!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin -->
     <div class="mt-6 text-center"><button onclick="showAdminLogin()" class="inline-flex items-center px-5 py-3 text-blue-600 hover:text-blue-800 font-medium transition-colors">
       <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
       </svg> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin </button>
     </div>
    </div>
   </div><!-- ‡∏´‡∏ô‡πâ‡∏≤ Summary -->
   <div id="summaryPage" class="hidden min-h-full py-8 px-4">
    <div class="max-w-3xl mx-auto">
     <div class="bg-white rounded-2xl form-card p-6 md:p-8 fade-in">
      <div class="text-center mb-8">
       <div class="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-4">
        <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
       </div>
       <h2 class="text-2xl font-bold text-gray-800">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h2>
       <p class="text-gray-600 mt-2">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à</p>
      </div>
      <div id="summaryContent" class="space-y-4"><!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
      </div>
      <div class="mt-8 text-center"><button onclick="backToForm()" class="btn-primary px-8 py-4 text-white font-semibold rounded-xl inline-flex items-center">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
        </svg> ‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÉ‡∏´‡∏°‡πà </button>
      </div>
     </div>
    </div>
   </div><!-- ‡∏´‡∏ô‡πâ‡∏≤ Admin Login -->
   <div id="adminLoginPage" class="hidden min-h-full py-8 px-4 flex items-center justify-center">
    <div class="w-full max-w-md">
     <div class="bg-white rounded-2xl form-card p-8 fade-in">
      <div class="text-center mb-8">
       <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
        </svg>
       </div>
       <h2 class="text-2xl font-bold text-gray-800">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin</h2>
      </div>
      <form id="adminLoginForm" onsubmit="handleAdminLogin(event)">
       <div class="mb-5"><label for="adminId" class="block text-gray-700 font-medium mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label> <input type="text" id="adminId" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
       </div>
       <div class="mb-5"><label for="adminPassword" class="block text-gray-700 font-medium mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label> <input type="password" id="adminPassword" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
        </div>
       <p id="adminLoginError" class="error-text hidden mb-4 text-center">‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p><button type="submit" class="btn-primary w-full px-6 py-4 text-white font-semibold rounded-xl"> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö </button>
      </form>
      <div class="mt-6 text-center"><button onclick="backToForm()" class="text-blue-600 hover:text-blue-800 font-medium transition-colors"> ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° </button>
      </div>
     </div>
    </div>
   </div><!-- ‡∏´‡∏ô‡πâ‡∏≤ Admin Dashboard -->
   <div id="adminDashboardPage" class="hidden min-h-full py-8 px-4">
    <div class="max-w-7xl mx-auto">
     <div class="bg-white rounded-2xl form-card p-6 md:p-8 fade-in"><!-- Header -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
       <div>
        <h2 class="text-2xl font-bold text-gray-800">üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î Admin</h2>
        <p class="text-gray-600 mt-1">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</p>
       </div>
       <div class="flex flex-wrap gap-3 mt-4 md:mt-0"><button onclick="openCanvaSheet()" class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors">
         <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
         </svg> ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• </button> <button onclick="showChangePasswordModal()" class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">
         <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
         </svg> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô </button> <button onclick="backToForm()" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium rounded-lg transition-colors">
         <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12" />
         </svg> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° </button> <button onclick="logoutAdmin()" class="inline-flex items-center px-4 py-2 bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors">
         <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
         </svg> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö </button>
       </div>
      </div><!-- Stats -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
       <div class="bg-blue-50 rounded-xl p-5">
        <div class="flex items-center">
         <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
         </div>
         <div class="ml-4">
          <p class="text-gray-600 text-sm">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
          <p id="totalResponses" class="text-2xl font-bold text-blue-600">0</p>
         </div>
        </div>
       </div>
       <div class="bg-green-50 rounded-xl p-5">
        <div class="flex items-center">
         <div class="w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
         </div>
         <div class="ml-4">
          <p class="text-gray-600 text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö</p>
          <p class="text-lg font-bold text-green-600">‡∏õ‡∏Å‡∏ï‡∏¥</p>
         </div>
        </div>
       </div>
       <div class="bg-purple-50 rounded-xl p-5">
        <div class="flex items-center">
         <div class="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
         </div>
         <div class="ml-4">
          <p class="text-gray-600 text-sm">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
          <p id="lastUpdate" class="text-sm font-medium text-purple-600">-</p>
         </div>
        </div>
       </div>
      </div><!-- Table -->
      <div class="table-container rounded-xl border border-gray-200 overflow-hidden">
       <table class="admin-table w-full text-sm">
        <thead>
         <tr class="text-white text-left">
          <th class="px-4 py-4 font-semibold">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th class="px-4 py-4 font-semibold">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
          <th class="px-4 py-4 font-semibold">‡πÄ‡∏û‡∏®</th>
          <th class="px-4 py-4 font-semibold">‡∏≠‡∏≤‡∏¢‡∏∏</th>
          <th class="px-4 py-4 font-semibold">‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</th>
          <th class="px-4 py-4 font-semibold">‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤</th>
          <th class="px-4 py-4 font-semibold">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th>
          <th class="px-4 py-4 font-semibold">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</th>
          <th class="px-4 py-4 font-semibold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
          <th class="px-4 py-4 font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>
         </tr>
        </thead>
        <tbody id="dataTableBody"><!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
        </tbody>
       </table>
      </div>
      <div id="noDataMessage" class="hidden text-center py-12">
       <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
       </svg>
       <p class="text-gray-500 text-lg">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
      </div>
     </div>
    </div>
   </div>
  </div><!-- Modal ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô -->
  <div id="changePasswordModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
   <div class="bg-white rounded-2xl form-card p-8 w-full max-w-md fade-in">
    <div class="text-center mb-6">
     <div class="inline-flex items-center justify-center w-14 h-14 bg-blue-100 rounded-full mb-3">
      <svg class="w-7 h-7 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
      </svg>
     </div>
     <h3 class="text-xl font-bold text-gray-800">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h3>
    </div>
    <form id="changePasswordForm" onsubmit="handleChangePassword(event)">
     <div class="mb-4"><label for="currentPassword" class="block text-gray-700 font-medium mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏°</label> <input type="password" id="currentPassword" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏°">
     </div>
     <div class="mb-4"><label for="newPassword" class="block text-gray-700 font-medium mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label> <input type="password" id="newPassword" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">
     </div>
     <div class="mb-4"><label for="confirmPassword" class="block text-gray-700 font-medium mb-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label> <input type="password" id="confirmPassword" class="input-field w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">
     </div>
     <p id="changePasswordError" class="error-text hidden mb-4 text-center"></p>
     <p id="changePasswordSuccess" class="hidden mb-4 text-center text-green-600 font-medium"></p>
     <div class="flex gap-3"><button type="submit" class="btn-primary flex-1 px-4 py-3 text-white font-semibold rounded-lg"> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å </button> <button type="button" onclick="closeChangePasswordModal()" class="flex-1 px-4 py-3 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors"> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å </button>
     </div>
    </form>
   </div>
  </div>
  <script>
        // ========== Global Variables ==========
        let surveyData = [];
        let isSubmitting = false;

        const defaultConfig = {
            form_title: '‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û',
            organization_name: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏™‡∏á‡∏Ç‡∏•‡∏≤'
        };

        // ========== Initialize SDKs ==========
        async function initApp() {
            // Initialize Element SDK
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    onConfigChange: async (config) => {
                        document.getElementById('formTitle').textContent = config.form_title || defaultConfig.form_title;
                        document.getElementById('orgName').textContent = config.organization_name || defaultConfig.organization_name;
                    },
                    mapToCapabilities: (config) => ({
                        recolorables: [],
                        borderables: [],
                        fontEditable: undefined,
                        fontSizeable: undefined
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ['form_title', config.form_title || defaultConfig.form_title],
                        ['organization_name', config.organization_name || defaultConfig.organization_name]
                    ])
                });
            }

            // Initialize Data SDK
            if (window.dataSdk) {
                const dataHandler = {
                    onDataChanged(data) {
                        surveyData = data.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                        updateDashboard();
                    }
                };
                
                const result = await window.dataSdk.init(dataHandler);
                if (!result.isOk) {
                    console.error('Failed to initialize Data SDK');
                }
            } else {
                // If Data SDK not available, load from localStorage (fallback)
                const storedData = localStorage.getItem('trainingSurveyData');
                if (storedData) {
                    surveyData = JSON.parse(storedData).sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                }
            }

            // Initialize Admin Account
            initAdminAccount();

            // Setup radio button styling
            setupRadioButtons();
            setupCheckboxes();
        }

        // ========== Admin Account ==========
        function initAdminAccount() {
            let adminAccount = localStorage.getItem('adminAccount');
            if (!adminAccount) {
                localStorage.setItem('adminAccount', JSON.stringify({ id: 'admin', password: '1234' }));
            }
        }

        // ========== Radio & Checkbox Styling ==========
        function setupRadioButtons() {
            document.querySelectorAll('.radio-custom').forEach(radio => {
                radio.addEventListener('change', function() {
                    const name = this.name;
                    document.querySelectorAll(`input[name="${name}"]`).forEach(r => {
                        const label = r.nextElementSibling;
                        const dot = label.querySelector('span span');
                        if (r.checked) {
                            label.classList.add('bg-blue-50', 'border-blue-500');
                            if (dot) dot.classList.remove('hidden');
                        } else {
                            label.classList.remove('bg-blue-50', 'border-blue-500');
                            if (dot) dot.classList.add('hidden');
                        }
                    });
                });
            });
        }

        function setupCheckboxes() {
            document.querySelectorAll('.checkbox-custom').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const label = this.nextElementSibling;
                    const checkmark = label.querySelector('span svg');
                    if (this.checked) {
                        label.parentElement.parentElement.classList.add('bg-blue-50', 'border-blue-500');
                        if (checkmark) checkmark.classList.remove('hidden');
                    } else {
                        label.parentElement.parentElement.classList.remove('bg-blue-50', 'border-blue-500');
                        if (checkmark) checkmark.classList.add('hidden');
                    }
                });
            });
        }

        // ========== Toggle Functions ==========
        function toggleEducationOther() {
            const edu7 = document.getElementById('edu7');
            const container = document.getElementById('educationOtherContainer');
            if (edu7.checked) {
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }

        function toggleProvinceFields() {
            const prov1 = document.getElementById('prov1');
            const prov5 = document.getElementById('prov5');
            const songkhlaContainer = document.getElementById('songkhlaDistrictContainer');
            const otherContainer = document.getElementById('provinceOtherContainer');

            songkhlaContainer.classList.add('hidden');
            otherContainer.classList.add('hidden');

            if (prov1.checked) {
                songkhlaContainer.classList.remove('hidden');
            } else if (prov5.checked) {
                otherContainer.classList.remove('hidden');
            }
        }

        function toggleCourseDetail(type) {
            const checkbox = document.getElementById(`course${type === 'digital' ? '1' : type === 'craft' ? '2' : type === 'mechanic' ? '3' : type === 'agriculture' ? '4' : '5'}`);
            const detail = document.getElementById(`course${type.charAt(0).toUpperCase() + type.slice(1)}Detail`);
            if (checkbox.checked) {
                detail.classList.remove('hidden');
            } else {
                detail.classList.add('hidden');
            }
        }

        // ========== Form Validation ==========
        function validateForm() {
            let isValid = true;
            
            // Reset errors
            document.querySelectorAll('.error-text').forEach(el => el.classList.add('hidden'));
            
            // Validate fullname
            const fullname = document.getElementById('fullname').value.trim();
            if (!fullname) {
                document.getElementById('fullnameError').classList.remove('hidden');
                isValid = false;
            }

            // Validate gender
            const gender = document.querySelector('input[name="gender"]:checked');
            if (!gender) {
                document.getElementById('genderError').classList.remove('hidden');
                isValid = false;
            }

            // Validate age
            const age = document.querySelector('input[name="age"]:checked');
            if (!age) {
                document.getElementById('ageError').classList.remove('hidden');
                isValid = false;
            }

            // Validate education
            const education = document.querySelector('input[name="education"]:checked');
            if (!education) {
                document.getElementById('educationError').classList.remove('hidden');
                isValid = false;
            }

            // Validate province
            const province = document.querySelector('input[name="province"]:checked');
            if (!province) {
                document.getElementById('provinceError').classList.remove('hidden');
                isValid = false;
            }

            // Validate training time
            const trainingTime = document.getElementById('trainingTime').value.trim();
            if (!trainingTime) {
                document.getElementById('trainingTimeError').classList.remove('hidden');
                isValid = false;
            }

            // Validate training location
            const trainingLocation = document.getElementById('trainingLocation').value.trim();
            if (!trainingLocation) {
                document.getElementById('trainingLocationError').classList.remove('hidden');
                isValid = false;
            }

            return isValid;
        }

        // ========== Form Submission ==========
        document.getElementById('surveyForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (isSubmitting) return;
            if (!validateForm()) {
                // Scroll to first error
                const firstError = document.querySelector('.error-text:not(.hidden)');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return;
            }

            isSubmitting = true;
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const submitSpinner = document.getElementById('submitSpinner');
            
            submitBtn.disabled = true;
            submitBtnText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            submitSpinner.classList.remove('hidden');

            // Collect form data
            const formData = collectFormData();

            // Save to Data SDK with record limit check
            if (window.dataSdk) {
                try {
                    const result = await window.dataSdk.create(formData);
                    if (result.isOk) {
                        showSummary(formData);
                    } else {
                        const errorMsg = result.error?.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                if (errorMsg.includes('999') || errorMsg.includes('limit')) {
                            showToast('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß (999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö', 'error');
                        } else {
                            showToast(errorMsg, 'error');
                        }
                    }
                } catch (error) {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠', 'error');
                }
            } else {
                // Fallback to localStorage if SDK not available
                let localData = JSON.parse(localStorage.getItem('trainingSurveyData') || '[]');
                if (localData.length >= 999) {
                    showToast('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß (999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö', 'error');
                } else {
                    localData.push(formData);
                    localStorage.setItem('trainingSurveyData', JSON.stringify(localData));
                    showSummary(formData);
                }
            }

            resetSubmitButton();
        });

        function collectFormData() {
            const gender = document.querySelector('input[name="gender"]:checked');
            const age = document.querySelector('input[name="age"]:checked');
            const education = document.querySelector('input[name="education"]:checked');
            const province = document.querySelector('input[name="province"]:checked');
            const courses = document.querySelectorAll('input[name="courses"]:checked');

            let coursesArray = [];
            courses.forEach(c => coursesArray.push(c.value));

            let educationValue = education ? education.value : '';
            if (educationValue === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ') {
                const other = document.getElementById('educationOther').value.trim();
                if (other) educationValue = `‡∏≠‡∏∑‡πà‡∏ô ‡πÜ: ${other}`;
            }

            let provinceValue = province ? province.value : '';
            let districtValue = '';
            if (provinceValue === '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏á‡∏Ç‡∏•‡∏≤') {
                districtValue = document.getElementById('songkhlaDistrict').value.trim();
                if (districtValue) provinceValue = `${provinceValue} (‡∏≠‡∏≥‡πÄ‡∏†‡∏≠${districtValue})`;
            } else if (provinceValue === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ') {
                const other = document.getElementById('provinceOther').value.trim();
                if (other) provinceValue = other;
            }

            return {
                fullname: document.getElementById('fullname').value.trim(),
                gender: gender ? gender.value : '',
                age: age ? age.value : '',
                education: educationValue,
                education_other: document.getElementById('educationOther').value.trim(),
                province: provinceValue,
                province_district: districtValue,
                province_other: document.getElementById('provinceOther').value.trim(),
                courses: coursesArray.join(', '),
                course_digital: document.getElementById('courseDigitalText').value.trim(),
                course_craft: document.getElementById('courseCraftText').value.trim(),
                course_mechanic: document.getElementById('courseMechanicText').value.trim(),
                course_agriculture: document.getElementById('courseAgricultureText').value.trim(),
                course_other: document.getElementById('courseOtherText').value.trim(),
                training_time: document.getElementById('trainingTime').value.trim(),
                training_location: document.getElementById('trainingLocation').value.trim(),
                suggestions: document.getElementById('suggestions').value.trim(),
                created_at: new Date().toISOString()
            };
        }

        function resetSubmitButton() {
            isSubmitting = false;
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const submitSpinner = document.getElementById('submitSpinner');
            
            submitBtn.disabled = false;
            submitBtnText.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            submitSpinner.classList.add('hidden');
        }

        // ========== Summary Page ==========
        function showSummary(data) {
            document.getElementById('formPage').classList.add('hidden');
            document.getElementById('summaryPage').classList.remove('hidden');

            const summaryContent = document.getElementById('summaryContent');
            summaryContent.innerHTML = `
                <div class="bg-gray-50 rounded-xl p-5 space-y-3">
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</span>
                        <span class="font-medium text-gray-800">${data.fullname || '-'}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡πÄ‡∏û‡∏®:</span>
                        <span class="font-medium text-gray-800">${data.gender || '-'}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡∏≠‡∏≤‡∏¢‡∏∏:</span>
                        <span class="font-medium text-gray-800">${data.age || '-'}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</span>
                        <span class="font-medium text-gray-800">${data.education || '-'}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤:</span>
                        <span class="font-medium text-gray-800">${data.province || '-'}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</span>
                        <span class="font-medium text-gray-800">${data.courses || '-'}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°:</span>
                        <span class="font-medium text-gray-800">${data.training_time || '-'}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-200 pb-2">
                        <span class="text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°:</span>
                        <span class="font-medium text-gray-800">${data.training_location || '-'}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</span>
                        <span class="font-medium text-gray-800">${formatDate(data.created_at)}</span>
                    </div>
                </div>
            `;

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ========== Clear Form ==========
        function clearForm() {
            document.getElementById('surveyForm').reset();
            document.querySelectorAll('.error-text').forEach(el => el.classList.add('hidden'));
            
            // Reset radio button styling
            document.querySelectorAll('.radio-custom').forEach(radio => {
                const label = radio.nextElementSibling;
                const dot = label.querySelector('span span');
                label.classList.remove('bg-blue-50', 'border-blue-500');
                if (dot) dot.classList.add('hidden');
            });

            // Reset checkbox styling
            document.querySelectorAll('.checkbox-custom').forEach(checkbox => {
                const label = checkbox.nextElementSibling;
                const checkmark = label.querySelector('span svg');
                label.parentElement.parentElement.classList.remove('bg-blue-50', 'border-blue-500');
                if (checkmark) checkmark.classList.add('hidden');
            });

            // Hide conditional fields
            document.getElementById('educationOtherContainer').classList.add('hidden');
            document.getElementById('songkhlaDistrictContainer').classList.add('hidden');
            document.getElementById('provinceOtherContainer').classList.add('hidden');
            document.getElementById('courseDigitalDetail').classList.add('hidden');
            document.getElementById('courseCraftDetail').classList.add('hidden');
            document.getElementById('courseMechanicDetail').classList.add('hidden');
            document.getElementById('courseAgricultureDetail').classList.add('hidden');
            document.getElementById('courseOtherDetail').classList.add('hidden');

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ========== Navigation ==========
        function backToForm() {
            document.getElementById('formPage').classList.remove('hidden');
            document.getElementById('summaryPage').classList.add('hidden');
            document.getElementById('adminLoginPage').classList.add('hidden');
            document.getElementById('adminDashboardPage').classList.add('hidden');
            clearForm();
        }

        // ========== Admin Functions ==========
        function showAdminLogin() {
            document.getElementById('formPage').classList.add('hidden');
            document.getElementById('adminLoginPage').classList.remove('hidden');
            document.getElementById('adminLoginError').classList.add('hidden');
            document.getElementById('adminId').value = '';
            document.getElementById('adminPassword').value = '';
        }

        function handleAdminLogin(e) {
            e.preventDefault();
            const id = document.getElementById('adminId').value.trim();
            const password = document.getElementById('adminPassword').value;
            
            const adminAccount = JSON.parse(localStorage.getItem('adminAccount') || '{}');
            
            if (id === adminAccount.id && password === adminAccount.password) {
                document.getElementById('adminLoginPage').classList.add('hidden');
                document.getElementById('adminDashboardPage').classList.remove('hidden');
                loadDashboardData();
            } else {
                document.getElementById('adminLoginError').classList.remove('hidden');
            }
        }

        function logoutAdmin() {
            document.getElementById('adminDashboardPage').classList.add('hidden');
            document.getElementById('formPage').classList.remove('hidden');
        }

        // ========== Change Password Functions ==========
        function showChangePasswordModal() {
            const modal = document.getElementById('changePasswordModal');
            if (modal) {
                modal.classList.remove('hidden');
                // Reset form
                const form = document.getElementById('changePasswordForm');
                if (form) form.reset();
                const errorEl = document.getElementById('changePasswordError');
                const successEl = document.getElementById('changePasswordSuccess');
                if (errorEl) errorEl.classList.add('hidden');
                if (successEl) successEl.classList.add('hidden');
            }
        }

        function closeChangePasswordModal() {
            const modal = document.getElementById('changePasswordModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        function handleChangePassword(e) {
            e.preventDefault();

            const errorEl = document.getElementById('changePasswordError');
            const successEl = document.getElementById('changePasswordSuccess');
            
            if (!errorEl || !successEl) return;

            // Reset messages
            errorEl.classList.add('hidden');
            successEl.classList.add('hidden');
            errorEl.textContent = '';
            successEl.textContent = '';

            const currentPassword = document.getElementById('currentPassword');
            const newPassword = document.getElementById('newPassword');
            const confirmPassword = document.getElementById('confirmPassword');

            if (!currentPassword || !newPassword || !confirmPassword) return;

            const currPass = currentPassword.value.trim();
            const newPass = newPassword.value.trim();
            const confirmPass = confirmPassword.value.trim();

            // Validation
            if (!currPass || !newPass || !confirmPass) {
                errorEl.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
                errorEl.classList.remove('hidden');
                return;
            }

            if (newPass !== confirmPass) {
                errorEl.textContent = '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô';
                errorEl.classList.remove('hidden');
                return;
            }

            try {
                const adminAccountStr = localStorage.getItem('adminAccount');
                if (!adminAccountStr) {
                    errorEl.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Admin';
                    errorEl.classList.remove('hidden');
                    return;
                }

                const adminAccount = JSON.parse(adminAccountStr);
                
                if (currPass !== adminAccount.password) {
                    errorEl.textContent = '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                    errorEl.classList.remove('hidden');
                    return;
                }

                // Update password
                adminAccount.password = newPass;
                localStorage.setItem('adminAccount', JSON.stringify(adminAccount));

                successEl.textContent = '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
                successEl.classList.remove('hidden');

                // Close modal after 2 seconds
                setTimeout(() => {
                    closeChangePasswordModal();
                }, 2000);

            } catch (err) {
                errorEl.textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
                errorEl.classList.remove('hidden');
            }
        }

        // Close modal when clicking outside
        const modal = document.getElementById('changePasswordModal');
        if (modal) {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeChangePasswordModal();
                }
            });
        }

        // ========== Dashboard Functions ==========
        function loadDashboardData() {
            let data = surveyData;
            
            // If SDK data is empty, try localStorage (fallback)
            if (data.length === 0 && !window.dataSdk) {
                data = JSON.parse(localStorage.getItem('trainingSurveyData') || '[]');
                data.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
            }

            updateDashboardTable(data);
        }

        function updateDashboard() {
            if (!document.getElementById('adminDashboardPage').classList.contains('hidden')) {
                updateDashboardTable(surveyData);
            }
        }

        function updateDashboardTable(data) {
            const tbody = document.getElementById('dataTableBody');
            const noDataMsg = document.getElementById('noDataMessage');
            const totalResponses = document.getElementById('totalResponses');
            const lastUpdate = document.getElementById('lastUpdate');

            totalResponses.textContent = data.length;

            if (data.length === 0) {
                tbody.innerHTML = '';
                noDataMsg.classList.remove('hidden');
                lastUpdate.textContent = '-';
                return;
            }

            noDataMsg.classList.add('hidden');
            lastUpdate.textContent = formatDate(data[0].created_at);

            tbody.innerHTML = data.map((item, index) => `
                <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors">
                    <td class="px-4 py-3 text-gray-800">${index + 1}</td>
                    <td class="px-4 py-3 text-gray-800 font-medium">${item.fullname || '-'}</td>
                    <td class="px-4 py-3 text-gray-600">${item.gender || '-'}</td>
                    <td class="px-4 py-3 text-gray-600">${item.age || '-'}</td>
                    <td class="px-4 py-3 text-gray-600">${item.education || '-'}</td>
                    <td class="px-4 py-3 text-gray-600">${item.province || '-'}</td>
                    <td class="px-4 py-3 text-gray-600 max-w-xs truncate" title="${item.courses || '-'}">${item.courses || '-'}</td>
                    <td class="px-4 py-3 text-gray-600">${item.training_time || '-'}</td>
                    <td class="px-4 py-3 text-gray-600">${item.training_location || '-'}</td>
                    <td class="px-4 py-3 text-gray-500 text-xs">${formatDate(item.created_at)}</td>
                </tr>
            `).join('');
        }

        // ========== Canva Sheet Function ==========
        function openCanvaSheet() {
            const data = surveyData.length > 0 ? surveyData : JSON.parse(localStorage.getItem('trainingSurveyData') || '[]');
            
            if (data.length === 0) {
                showToast('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Canva Sheet', 'warning');
                return;
            }

            // Create formatted data for display
            const headers = ['‡∏•‡∏≥‡∏î‡∏±‡∏ö', '‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•', '‡πÄ‡∏û‡∏®', '‡∏≠‡∏≤‡∏¢‡∏∏', '‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤', '‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤', '‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å', '‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å'];
            
            let csvContent = headers.join(',') + '\n';
            
            data.forEach((item, index) => {
                const row = [
                    index + 1,
                    `"${item.fullname || '-'}"`,
                    `"${item.gender || '-'}"`,
                    `"${item.age || '-'}"`,
                    `"${item.education || '-'}"`,
                    `"${item.province || '-'}"`,
                    `"${item.courses || '-'}"`,
                    `"${item.training_time || '-'}"`,
                    `"${item.training_location || '-'}"`,
                    `"${formatDate(item.created_at)}"`
                ];
                csvContent += row.join(',') + '\n';
            });

            // Create a blob and open in new window
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            
            // Open in new tab with data display
            const newWindow = window.open('', '_blank');
            if (newWindow) {
                newWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à - Canva Sheet View</title>
                        <style>
                            body { font-family: 'Sarabun', Arial, sans-serif; padding: 20px; background: #f5f5f5; }
                            h1 { color: #1e40af; text-align: center; }
                            table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
                            th { background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); color: white; padding: 12px; text-align: left; }
                            td { padding: 10px 12px; border-bottom: 1px solid #e5e7eb; }
                            tr:hover { background: #f8fafc; }
                            .info { text-align: center; margin: 20px 0; color: #666; }
                        </style>
                    </head>
                    <body>
                        <h1>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</h1>
                        <p class="info">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏™‡∏á‡∏Ç‡∏•‡∏≤ | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                        <table>
                            <thead>
                                <tr>
                                    ${headers.map(h => `<th>${h}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                ${data.map((item, index) => `
                                    <tr>
                                        <td>${index + 1}</td>
                                        <td>${item.fullname || '-'}</td>
                                        <td>${item.gender || '-'}</td>
                                        <td>${item.age || '-'}</td>
                                        <td>${item.education || '-'}</td>
                                        <td>${item.province || '-'}</td>
                                        <td>${item.courses || '-'}</td>
                                        <td>${item.training_time || '-'}</td>
                                        <td>${item.training_location || '-'}</td>
                                        <td>${formatDate(item.created_at)}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        <p class="info">‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Canva ‡∏´‡∏£‡∏∑‡∏≠ Excel ‡πÑ‡∏î‡πâ</p>
                    </body>
                    </html>
                `);
                newWindow.document.close();
            }

            showToast('‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Canva Sheet View ‡πÅ‡∏•‡πâ‡∏ß', 'success');
        }

        // ========== Utility Functions ==========
        function formatDate(dateStr) {
            if (!dateStr) return '-';
            try {
                const date = new Date(dateStr);
                return date.toLocaleDateString('th-TH', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } catch {
                return '-';
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 fade-in ${
                type === 'success' ? 'bg-green-600 text-white' :
                type === 'error' ? 'bg-red-600 text-white' :
                'bg-yellow-500 text-white'
            }`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transition = 'opacity 0.3s';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ========== Initialize App ==========
        initApp();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d036acb670b10ca',t:'MTc3MTQ3OTQ5OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>